#!/bin/bash -e

pid=pid/resque.pid
log=log/resque.log

source $OPENSHIFT_CARTRIDGE_SDK_BASH
source "${OPENSHIFT_RUBY_DIR}/lib/util"
source "${OPENSHIFT_RUBY_DIR}/lib/ruby_context"

function start() {
    echo "Starting resque worker"

    #TODO: is redis running?

    ruby_context "env TERM_CHILD=1  QUEUE=* PIDFILE=$pid BACKGROUND=yes rake resque:work"
}

function stop() {
    echo "Stopping resque worker"

}

function status() {
    echo
}

function update() {
    echo
}


function restart() {
    echo
}

function build() {
    echo
}

function post-deploy() {
    echo
}

function pre-build() {
    echo
}

function tidy() {
    echo
}

case "$1" in
  start)             start ;;
  stop)              stop ;;
  restart | reload ) restart $1 ;;
  status)            status ;;
  tidy)              tidy ;;
  pre-build)         pre-build ;;
  build)             build ;;
  deploy)            deploy ;;
  post-deploy)       post-deploy ;;
  *)                 exit 0
esac