#!/bin/bash -e

pid=pid/resque.pid
log=log/resque.log

source $OPENSHIFT_CARTRIDGE_SDK_BASH
source "${OPENSHIFT_RUBY_DIR}/lib/util"
source "${OPENSHIFT_RUBY_DIR}/lib/ruby_context"

function start() {
    echo "Starting resque worker"

    #is redis running?

    ruby_context "env TERM_CHILD=1  QUEUE=* PIDFILE=$pid BAKCGROUND=yes rake resque:work"
}

function stop() {
    echo "Stoping resque worker"

}

case "$1" in
  start)             start ;;
  stop)              stop ;;
  restart | reload ) restart $1 ;;
  status)            status ;;
  tidy)              tidy ;;
  pre-repo-archive)  pre-repo-archive ;;
  pre-build)         pre-build ;;
  build)             build ;;
  deploy)            deploy ;;
  post-deploy)       post-deploy ;;
  threaddump)        threaddump ;;
  update-configuration)   update-configuration $OPENSHIFT_RUBY_VERSION;;
  *)                 exit 0
esac